const express = require('express')

module.exports = serviceFeed => {
  const router = express.Router()

  router.get('/',  (req, res, next)=> {
    res.setHeader('Content-Type', 'application/json');
    
    {  serviceFeed.getFeeds(new Date())(req.app.locals.lang)((error, data)=>
      {
        if(error)
          err = '{"errors": error.message}'


          if (req.app.locals.t["ERRORS"] == undefined || req.app.locals.t["ERRORS"]["FEEDS_ERROR"] === undefined)
            res.status(500).json(JSON.parse(err))
          else
            res.status(500).json({"errors": [req.app.locals.t["ERRORS"]["FEEDS_ERROR"]]})

        else
          //res.setHeader('Content-Type', 'application/json');
          res.status(200).json(data)
      })
    } 
  }
  )

  return router
}
